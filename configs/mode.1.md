
---
## 员工详情实体(`user_employee`)

员工详情
该内容未完,可进行扩展处理
内容暂时处于保留方式

| 字段          | 中文说明       | 字段类型 | 备注                                                | MYSQL                                                |
| ------------- | -------------- | -------- | ---------------------------------------------------------------------------------------------------------- |
| id            | 唯一标识       | 数值     |                                                     | int(11) NOT NULL, primary,fk_user_employee->user.id  |
| kid           | 唯一标识       | 字符串   |                                                     | varchar(64), udx_user_employee_kid                   |
| ------------------------------------------------------------------------------------------------------------------------------------------------------ |
| nickname      | 昵称           | 字符串   |                                                     | varchar(64)                                          |
| avatar        | 头像           | 字符串   |                                                     | varchar(255)                                         |
| mfa_secret    | MFA密钥        | 字符串   |                                                     | varchar(1024)                                        |
| deleted       | 逻辑删除       | 数值     | 用户不能删除,但是员工可以逻辑删除                   | tinyint(4) DEFAULT 0                                 |
| ------------------------------------------------------------------------------------------------------------------------------------------------------ |
| org_code      | 组织标识       | 字符串   | 冗余辅助字段，角色中包含org_code                    | varchar(64), fk_user_employee_roc->role.org_code     |
| ------------------------------------------------------------------------------------------------------------------------------------------------------ |
| creator       | 创建人         | 字符串   |                                                     | varchar(64)                                          |
| created_at    | 创建时间       | 时间格式 |                                                     | timestamp                                            |
| updated_at    | 更新时间       | 时间格式 |                                                     | timestamp                                            |
| version       | 数据版本       | 数值     |                                                     | int(11) DEFAULT 0                                    |
| ------------------------------------------------------------------------------------------------------------------------------------------------------ |
| string_1      | 备用字段       | 字符串   |                                                     | varchar(255)                                         |
| number_1      | 备用字段       | 数值     |                                                     | int(11)                                              |

---
## 顾客详情实体(`user_customer`)

顾客详情
该内容未完,可进行扩展处理
内容暂时处于保留方式

| 字段          | 中文说明       | 字段类型 | 备注                                                | MYSQL                                                |
| ------------- | -------------- | -------- | ---------------------------------------------------------------------------------------------------------- |
| id            | 唯一标识       | 数值     |                                                     | int(11) NOT NULL, primary,fk_user_customer->user.id  |
| kid           | 昵称           | 字符串   |                                                     | varchar(64), udx_user_customer                       |
| ------------------------------------------------------------------------------------------------------------------------------------------------------ |
| nickname      | 昵称           | 字符串   |                                                     | varchar(64)                                          |
| avatar        | 头像           | 字符串   |                                                     | varchar(255)                                         |
| mfa_secret    | MFA密钥        | 字符串   |                                                     | varchar(1024)                                        |
| ------------------------------------------------------------------------------------------------------------------------------------------------------ |
| org_code      | 组织标识       | 字符串   | 冗余辅助字段，角色中包含org_code                    | varchar(64), fk_user_customer_roc->role.org_code     |
| ------------------------------------------------------------------------------------------------------------------------------------------------------ |
| creator       | 创建人         | 字符串   |                                                     | varchar(64)                                          |
| created_at    | 创建时间       | 时间格式 |                                                     | timestamp                                            |
| updated_at    | 更新时间       | 时间格式 |                                                     | timestamp                                            |
| version       | 数据版本       | 数值     |                                                     | int(11) DEFAULT 0                                    |
| ------------------------------------------------------------------------------------------------------------------------------------------------------ |
| string_1      | 备用字段       | 字符串   |                                                     | varchar(255)                                         |
| number_1      | 备用字段       | 数值     |                                                     | int(11)                                              |

---
## 用户消息实体(`user_message`)

主要用户系统通知

| 字段          | 中文说明       | 字段类型 | 备注                                                | MYSQL                                                |
| ------------- | -------------- | -------- | ---------------------------------------------------------------------------------------------------------- |
| id            | 唯一标识       | 数值     |                                                     | int(11) NOT NULL AUTO_INCREMENT, primary             |
| fo_id         | 发送消息       | 字符串   |                                                     | int(64), fk_user_message_fo_id->user.id              |
| to_id         | 发送消息       | 字符串   |                                                     | int(64), fk_user_message_to_id->user.id              |
| kid           | 索引           | 字符串   |                                                     | varchar(64), udx_user_message_kid                    |
| type          | 类型           | 字符串   |                                                     | varchar(16)                                          |
| title         | 标题           | 字符串   |                                                     | varchar(255)                                         |
| avatar        | 头像           | 字符串   |                                                     | varchar(255)                                         |
| send_time     | 发送日期       | 字符串   |                                                     | timestamp                                            |
| read_time     | 读取日期       | 字符串   |                                                     | timestamp                                            |
| status        | 状态           | 数值     |                                                     | tinyint(4)                                           |
| deleted       | 逻辑删除       | 数值     | 消息只能逻辑删除, 一遍平台查询                      | tinyint(4) DEFAULT 0                                 |
| description   | 描述           | 字符串   | 消息描述可以是任意格式                              | TEXT                                                 |
| click_close   | 关闭           | 数值     |                                                     | tinyint(4)                                           |
| ------------------------------------------------------------------------------------------------------------------------------------------------------ |
| org_code      | 组织标识       | 字符串   | 冗余辅助字段，角色中包含org_code                    | varchar(64), fk_user_message_roc->role.org_code      |
| touch_mode    | 触达方式       | 字符串   |                                                     | varchar(255)                                         |
| delay_time    | 延迟触达       | 数值     |                                                     | timestamp                                            |
| ------------------------------------------------------------------------------------------------------------------------------------------------------ |
| string_1      | 备用字段       | 字符串   |                                                     | varchar(255)                                         |
| number_1      | 备用字段       | 数值     |                                                     | int(11)                                              |
| string_2      | 备用字段       | 字符串   |                                                     | varchar(255)                                         |
| number_2      | 备用字段       | 数值     |                                                     | int(11)                                              |
| string_3      | 备用字段       | 字符串   |                                                     | varchar(255)                                         |
| number_3      | 备用字段       | 数值     |                                                     | int(11)                                              |

---
## 菜单实体(`menu`)

菜单

| 字段          | 中文说明       | 字段类型 | 备注                                                | MYSQL                                                |
| ------------- | -------------- | -------- | ---------------------------------------------------------------------------------------------------------- |
| id            | 唯一标识       | 数值     |                                                     | int(11) NOT NULL AUTO_INCREMENT, primary             |
| kid           | 唯一标识       | 字符串   |                                                     | varchar(32), udx_menu_kid                            |
| name          | 菜单名称       | 字符串   |                                                     | varchar(64)                                          |
| local         | 菜单名称       | 字符串   | 可以直接抽取前端i18n对应的内容                      | varchar(128)                                         |
| sequence      | 排序值         | 数值     |                                                     | tinyint(4) DEFAULT 64                                |
| group         | 菜单分组       | 字符串   |                                                     | varchar(64)                                          |
| group_local   | 菜单分组       | 字符串   |                                                     | varchar(64)                                          |
| icon          | 图标           | 字符串   |                                                     | varchar(255)                                         |
| router        | 访问路由       | 字符串   |                                                     | varchar(255)                                         |
| memo          | 备注           | 字符串   |                                                     | varchar(255)                                         |
| domain        | 域名           | 字符串   |                                                     | varchar(255)                                         |
| status        | 状态           | 数值     | 1:启用 0:禁用                                       | tinyint(4) DEFAULT 1                                 |
| ------------------------------------------------------------------------------------------------------------------------------------------------------ |
| creator       | 创建人         | 字符串   |                                                     | varchar(64)                                          |
| created_at    | 创建时间       | 时间格式 |                                                     | timestamp                                            |
| updated_at    | 更新时间       | 时间格式 |                                                     | timestamp                                            |
| version       | 数据版本       | 数值     |                                                     | int(11) DEFAULT 0                                    |
| ------------------------------------------------------------------------------------------------------------------------------------------------------ |
| string_1      | 备用字段       | 字符串   |                                                     | varchar(255)                                         |
| number_1      | 备用字段       | 数值     |                                                     | int(11)                                              |

---
## 角色自定义菜单实体(`role_menu`)

角色具有包含角色的性质,所有在处理角色上,需要遍历角色,规则如下:  
1.使用角色获取菜单, 如果非空,直接结束,由于角色递归, 需要进行递归遍历  
2.如果都没有的情况下,使用role_id=nil获取菜单,不进行递归,该菜单列表认为是所有人可见的默认菜单  
这里会出现一个状况,一个角色继承了二个以上的角色,这时候,同一个菜单会被展示多次,暂时并未想好合适的解决方式

| 字段          | 中文说明       | 字段类型 | 备注                                                | MYSQL                                                |
| ------------- | -------------- | -------- | ---------------------------------------------------------------------------------------------------------- |
| id            | 唯一标识       | 数值     |                                                     | int(11) NOT NULL AUTO_INCREMENT, primary             |
| pid           | 父节点         | 数值     |                                                     | int(11), idx_parent_id                               |
| kid           | 唯一标识       | 字符串   |                                                     | varchar(32), udx_menu_role_kid                       |
| name          | 菜单名称       | 字符串   | 父节点不能为空,子节点为空,使用menu_id替换           | varchar(64)                                          |
| local         | 菜单名称       | 字符串   |                                                     | varchar(128)                                         |
| sequence      | 排序值         | 数值     |                                                     | tinyint(4) DEFAULT 64                                |
| role_id       | 角色 ID        | 数值     |                                                     | int(11), fk_menu_role_role_id->role.id               |
| role_kid      | 角色 UID       | 字符串   | 与role_id效果相同                                   | varchar(64), idx_role_kid                            |
| menu_id       | 菜单 ID        | 数值     |                                                     | int(11), fk_menu_role_menu_id->menu.id               |
| ------------------------------------------------------------------------------------------------------------------------------------------------------ |
| creator       | 创建人         | 字符串   |                                                     | varchar(64)                                          |
| created_at    | 创建时间       | 时间格式 |                                                     | timestamp                                            |
| updated_at    | 更新时间       | 时间格式 |                                                     | timestamp                                            |
| version       | 数据版本       | 数值     |                                                     | int(11) DEFAULT 0                                    |

---
## 角色自定义菜单实体(`user_menu`)

用户自定义菜单, 用户可以在自己可以查看的菜单中选择常用的菜单,进行展示,
展示的内容

| 字段          | 中文说明       | 字段类型 | 备注                                                | MYSQL                                                |
| ------------- | -------------- | -------- | ---------------------------------------------------------------------------------------------------------- |
| id            | 唯一标识       | 数值     |                                                     | int(11) NOT NULL AUTO_INCREMENT, primary             |
| role_id       | 角色 ID        | 数值     |                                                     | int(11), fk_menu_user_role_id->user_role.id          |
| menu_id       | 菜单 ID        | 字符串   | menu kid list                                       | varchar(4096)                                        |
| ------------------------------------------------------------------------------------------------------------------------------------------------------ |
| creator       | 创建人         | 字符串   |                                                     | varchar(64)                                          |
| created_at    | 创建时间       | 时间格式 |                                                     | timestamp                                            |
| updated_at    | 更新时间       | 时间格式 |                                                     | timestamp                                            |
| version       | 数据版本       | 数值     |                                                     | int(11) DEFAULT 0                                    |

---
## 菜单事件实体(`menu_action`)

主要用户系统中对操作的隐藏,如果需要禁用,需要配合gateway使用,默认权限为启用
该内容一般用户初始化前端页面,用于对低权限的人屏蔽修改操作
由于casbin在系统中是由否定优先规则,即当系统中角色具有一票否决,通过role的向下遍历,确定角色上是否有操作的否决即可

| 字段          | 中文说明       | 字段类型 | 备注                                                | MYSQL                                                |
| ------------- | -------------- | -------- | ---------------------------------------------------------------------------------------------------------- |
| id            | 唯一标识       | 数值     |                                                     | int(11) NOT NULL AUTO_INCREMENT, primary             |
| menu_id       | 菜单 ID        | 数值     |                                                     | int(11), fk_menu_action_menu_id->menu.id             |
| role_id       | 角色 ID        | 数值     |                                                     | int(11), fk_menu_action_role_id->role.id             |
| code          | 动作编号       | 字符串   |                                                     | varchar(64), idx_menu_action_code                    |
| name          | 动作名称       | 字符串   |                                                     | varchar(64), idx_menu_action_name                    |
| disable       | 状态           | 数值     | 0:启用 1:禁用                                       | tinyint(4) DEFAULT 0                                 |
| ------------------------------------------------------------------------------------------------------------------------------------------------------ |
| creator       | 创建人         | 字符串   |                                                     | varchar(64)                                          |
| created_at    | 创建时间       | 时间格式 |                                                     | timestamp                                            |
| updated_at    | 更新时间       | 时间格式 |                                                     | timestamp                                            |
| version       | 数据版本       | 数值     |                                                     | int(11) DEFAULT 0                                    |
